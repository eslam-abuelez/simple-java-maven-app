pipeline {
    agent any

    tools {
        maven 'Maven-3.9.8' // Ensure this matches the name of the Maven installation in Jenkins
    }

    stages {
        stage('Clean Up') {
            steps {
                deleteDir()
            }
        }
        stage('Clone Repo') {
            steps {
                git 'https://github.com/jenkins-docs/simple-java-maven-app.git'
                sh 'ls -la' // List the contents of the workspace directory
                //sh 'ls -la simple-java-maven-app' // List the contents of the cloned directory
            }
        }
        stage('Build') {
            steps {
                 //dir('simple-java-maven-app') {
                    script {
                        sh 'mvn -version' // Print Maven version
                        if (fileExists('pom.xml')) {
                            sh 'mvn clean install'
                        } else {
                            error 'pom.xml not found in the directory'
                        }
                    }
                //}
            }
        }
        stage('Test') {
            steps {
                //dir('simple-java-maven-app') {
                    script {
                        if (fileExists('pom.xml')) {
                            sh 'mvn test'
                        } else {
                            error 'pom.xml not found in the directory'
                        }
                    //}
                }
            }
        }
    }
}
